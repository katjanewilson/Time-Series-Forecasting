<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 multiple regression models | Time Series Forecasting</title>
  <meta name="description" content="2 multiple regression models | Time Series Forecasting" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2 multiple regression models | Time Series Forecasting" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 multiple regression models | Time Series Forecasting" />
  
  
  

<meta name="author" content="Katherine Wilson" />


<meta name="date" content="2022-01-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="trends-and-seasonality.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#decomposition-models"><i class="fa fa-check"></i><b>1.1</b> Decomposition Models</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#model-assumptions"><i class="fa fa-check"></i><b>1.2</b> Model assumptions</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.3</b> Examples</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#example"><i class="fa fa-check"></i><b>1.3.1</b> Example</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#example-1"><i class="fa fa-check"></i><b>1.3.2</b> Example</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#example-2"><i class="fa fa-check"></i><b>1.3.3</b> Example</a></li>
<li class="chapter" data-level="1.3.4" data-path="index.html"><a href="index.html#example-3"><i class="fa fa-check"></i><b>1.3.4</b> Example</a></li>
<li class="chapter" data-level="1.3.5" data-path="index.html"><a href="index.html#example-4"><i class="fa fa-check"></i><b>1.3.5</b> Example</a></li>
<li class="chapter" data-level="1.3.6" data-path="index.html"><a href="index.html#example-5"><i class="fa fa-check"></i><b>1.3.6</b> Example</a></li>
<li class="chapter" data-level="1.3.7" data-path="index.html"><a href="index.html#example-6"><i class="fa fa-check"></i><b>1.3.7</b> Example</a></li>
<li class="chapter" data-level="1.3.8" data-path="index.html"><a href="index.html#example-7"><i class="fa fa-check"></i><b>1.3.8</b> Example</a></li>
<li class="chapter" data-level="1.3.9" data-path="index.html"><a href="index.html#example-8"><i class="fa fa-check"></i><b>1.3.9</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multiple-regression-models.html"><a href="multiple-regression-models.html"><i class="fa fa-check"></i><b>2</b> multiple regression models</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="multiple-regression-models.html"><a href="multiple-regression-models.html#additivie-decomposition-model-with-a-fourth-degree-polynomial-trend"><i class="fa fa-check"></i><b>2.0.1</b> additivie decomposition model with a fourth-degree polynomial trend</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html"><i class="fa fa-check"></i><b>3</b> trends and seasonality</a></li>
<li class="chapter" data-level="4" data-path="distributed-lag-models.html"><a href="distributed-lag-models.html"><i class="fa fa-check"></i><b>4</b> distributed lag models</a></li>
<li class="chapter" data-level="5" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>5</b> ARIMA models</a></li>
<li class="chapter" data-level="6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>6</b> exponential smoothing</a></li>
<li class="chapter" data-level="7" data-path="combination-of-forecasts.html"><a href="combination-of-forecasts.html"><i class="fa fa-check"></i><b>7</b> combination of forecasts</a></li>
<li class="chapter" data-level="8" data-path="arch-and-garch-models.html"><a href="arch-and-garch-models.html"><i class="fa fa-check"></i><b>8</b> ARCH and GARCH models</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series Forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-regression-models" class="section level1" number="2">
<h1><span class="header-section-number">2</span> multiple regression models</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="multiple-regression-models.html#cb1-1" aria-hidden="true" tabindex="-1"></a>usbeer <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/cloud/project/data/beernew.txt&quot;</span>)</span>
<span id="cb1-2"><a href="multiple-regression-models.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(usbeer)</span>
<span id="cb1-3"><a href="multiple-regression-models.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(usbeer)</span></code></pre></div>
<pre><code>##   year month time   beer        c348       s348       c432       s432
## 1 1987     1    1 15.601 -0.57757270  0.8163393 -0.9101060  0.4143756
## 2 1987     2    2 15.633 -0.33281954 -0.9429905  0.6565858 -0.7542514
## 3 1987     3    3 17.656  0.96202767  0.2729519 -0.2850193  0.9585218
## 4 1987     4    4 17.422 -0.77846230  0.6276914 -0.1377903 -0.9904614
## 5 1987     5    5 17.436 -0.06279052 -0.9980267  0.5358268  0.8443279
## 6 1987     6    6 18.584  0.85099448  0.5251746 -0.8375280 -0.5463943</code></pre>
<div id="additivie-decomposition-model-with-a-fourth-degree-polynomial-trend" class="section level3" number="2.0.1">
<h3><span class="header-section-number">2.0.1</span> additivie decomposition model with a fourth-degree polynomial trend</h3>
<p>Seasonal indices add to 0 for all t.
<span class="math display">\[
\begin{equation}
  y_t = \beta_0 + \beta_2t^2 +  \beta_3t^3 + \beta_4t^4 + S_t + \epsilon_t
\end{equation}
\]</span></p>
<p>R creates dummies.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="multiple-regression-models.html#cb3-1" aria-hidden="true" tabindex="-1"></a>fmonth<span class="ot">&lt;-</span><span class="fu">as.factor</span>(month)</span>
<span id="cb3-2"><a href="multiple-regression-models.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(fmonth)</span></code></pre></div>
<pre><code>##  [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot; &quot;11&quot; &quot;12&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="multiple-regression-models.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(time)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="multiple-regression-models.html#cb7-1" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(time)</span>
<span id="cb7-2"><a href="multiple-regression-models.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(time)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="multiple-regression-models.html#cb9-1" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span> <span class="fu">lm</span>(beer<span class="sc">~</span>time<span class="sc">+</span><span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(time<span class="sc">^</span><span class="dv">3</span>)<span class="sc">+</span><span class="fu">I</span>(time<span class="sc">^</span><span class="dv">4</span>)<span class="sc">+</span>fmonth);<span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = beer ~ time + I(time^2) + I(time^3) + I(time^4) + 
##     fmonth)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.33863 -0.26965  0.01012  0.25978  1.52952 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.556e+01  1.390e-01 111.933  &lt; 2e-16 ***
## time         1.523e-02  4.350e-03   3.502 0.000521 ***
## I(time^2)   -1.675e-04  4.732e-05  -3.540 0.000453 ***
## I(time^3)    6.496e-07  1.905e-07   3.410 0.000723 ***
## I(time^4)   -8.780e-10  2.533e-10  -3.466 0.000594 ***
## fmonth2     -6.423e-01  1.132e-01  -5.676 2.87e-08 ***
## fmonth3      1.579e+00  1.132e-01  13.950  &lt; 2e-16 ***
## fmonth4      1.447e+00  1.132e-01  12.786  &lt; 2e-16 ***
## fmonth5      2.595e+00  1.132e-01  22.930  &lt; 2e-16 ***
## fmonth6      2.862e+00  1.132e-01  25.289  &lt; 2e-16 ***
## fmonth7      2.363e+00  1.132e-01  20.874  &lt; 2e-16 ***
## fmonth8      1.950e+00  1.132e-01  17.223  &lt; 2e-16 ***
## fmonth9      2.838e-01  1.132e-01   2.507 0.012627 *  
## fmonth10     9.398e-03  1.132e-01   0.083 0.933896    
## fmonth11    -1.264e+00  1.132e-01 -11.161  &lt; 2e-16 ***
## fmonth12    -1.700e+00  1.133e-01 -15.013  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4455 on 356 degrees of freedom
## Multiple R-squared:  0.9237, Adjusted R-squared:  0.9204 
## F-statistic: 287.2 on 15 and 356 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>examine residuals</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="multiple-regression-models.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ts</span>(<span class="fu">resid</span>(model1),<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1987</span>,<span class="dv">1</span>),<span class="at">freq=</span><span class="dv">12</span>),<span class="at">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;residu als&quot;</span>,<span class="at">main=</span><span class="st">&quot;Residuals of Model 1&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>normal quantile plot of residuals. tails are a bit long relative to normaility. But not much of a problem. Null of Shapiro Wilk is normality of residuals</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="multiple-regression-models.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model1))</span>
<span id="cb12-2"><a href="multiple-regression-models.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(model1))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="multiple-regression-models.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(model1))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(model1)
## W = 0.99333, p-value = 0.09881</code></pre>
<p>Calculate and interpret estimated seasonal indices from the model. Selects estimated intercpet coefficients and the estimated coefficients for the fmonth dummies, then calculates the seasonal index estimates from these. In June, production is 2.072 million barrels above the level of the trendsâ€¦</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="multiple-regression-models.html#cb15-1" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="fu">coef</span>(model1)[<span class="dv">1</span>]</span>
<span id="cb15-2"><a href="multiple-regression-models.html#cb15-2" aria-hidden="true" tabindex="-1"></a>b2<span class="ot">&lt;-</span><span class="fu">coef</span>(model1)[<span class="dv">6</span><span class="sc">:</span><span class="dv">16</span>]<span class="sc">+</span>b1</span>
<span id="cb15-3"><a href="multiple-regression-models.html#cb15-3" aria-hidden="true" tabindex="-1"></a>b3<span class="ot">&lt;-</span><span class="fu">c</span>(b1,b2)</span>
<span id="cb15-4"><a href="multiple-regression-models.html#cb15-4" aria-hidden="true" tabindex="-1"></a>seas<span class="ot">&lt;-</span>b3<span class="sc">-</span><span class="fu">mean</span>(b3)</span>
<span id="cb15-5"><a href="multiple-regression-models.html#cb15-5" aria-hidden="true" tabindex="-1"></a>seas</span></code></pre></div>
<pre><code>## (Intercept)     fmonth2     fmonth3     fmonth4     fmonth5     fmonth6 
##  -0.7902230  -1.4325268   0.7884912   0.6568310   1.8049441   2.0721854 
##     fmonth7     fmonth8     fmonth9    fmonth10    fmonth11    fmonth12 
##   1.5725549   1.1594398  -0.5064181  -0.7808250  -2.0540390  -2.4904147</code></pre>
<p>Variable seas to time series clas sand plot indices</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="multiple-regression-models.html#cb17-1" aria-hidden="true" tabindex="-1"></a>seas.ts<span class="ot">&lt;-</span><span class="fu">ts</span>(seas)</span>
<span id="cb17-2"><a href="multiple-regression-models.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(seas.ts,<span class="at">ylab=</span><span class="st">&quot;seasonal indices&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;month&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Partial F tests and hypothesis. Partial F test tests the null that some of the regression coefficients are simultaneously 0. Fir two models, one with all regressers, and a reduces. In the latter, omit variables corresponding to the parameters which are hypothesized to be 0.</p>
<p>Suppose T is number of observations. The F stat for the partial F test can be calculated from the R squared of the two models. The F statistic is:
<span class="math display">\[
\begin{equation}
 F_{r,T-k-1} = \frac{((R^2(full)-R^2(reduced))/r}{(1-R^2(full))/(T-k-1)}
\end{equation}
\]</span></p>
<p>where numerator DF = r and T-k-1 denominator degrees of freedom. Reject null if partial F is large (p value small).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="multiple-regression-models.html#cb18-1" aria-hidden="true" tabindex="-1"></a>model2<span class="ot">&lt;-</span><span class="fu">lm</span>(beer<span class="sc">~</span>time<span class="sc">+</span><span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(time<span class="sc">^</span><span class="dv">3</span>)<span class="sc">+</span><span class="fu">I</span>(time<span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb18-2"><a href="multiple-regression-models.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = beer ~ time + I(time^2) + I(time^3) + I(time^4))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4602 -1.1566  0.1497  1.3892  3.0871 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.643e+01  4.099e-01  40.077   &lt;2e-16 ***
## time         1.386e-02  1.518e-02   0.913    0.362    
## I(time^2)   -1.643e-04  1.652e-04  -0.994    0.321    
## I(time^3)    6.708e-07  6.651e-07   1.008    0.314    
## I(time^4)   -9.418e-10  8.846e-10  -1.065    0.288    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.556 on 367 degrees of freedom
## Multiple R-squared:  0.04045,    Adjusted R-squared:  0.02999 
## F-statistic: 3.867 on 4 and 367 DF,  p-value: 0.004317</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="multiple-regression-models.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.9236588</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="multiple-regression-models.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.04044511</code></pre>
<p><span class="math display">\[
\begin{equation}
 F_{11,356} = \frac{((0.92366-0.04045)/11}{(1-0.92366)/(356)} = 374.43
\end{equation}
\]</span></p>
<p>confirm with test</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="multiple-regression-models.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model2,model1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: beer ~ time + I(time^2) + I(time^3) + I(time^4)
## Model 2: beer ~ time + I(time^2) + I(time^3) + I(time^4) + fmonth
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    367 888.27                                  
## 2    356  70.67 11     817.6 374.42 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Do residuals suggest that the model disturbance term forms an uncorrelated sequence? Measure lag 1 correlation of the residuals, correlation between residuals which are directly adjacent in time. Lag one correlation not significant.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="multiple-regression-models.html#cb26-1" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">resid</span>(model1)[<span class="dv">2</span><span class="sc">:</span><span class="dv">372</span>]</span>
<span id="cb26-2"><a href="multiple-regression-models.html#cb26-2" aria-hidden="true" tabindex="-1"></a>r1<span class="ot">&lt;-</span><span class="fu">resid</span>(model1)[<span class="dv">1</span><span class="sc">:</span><span class="dv">371</span>]</span>
<span id="cb26-3"><a href="multiple-regression-models.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(r,r1)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  r and r1
## t = 1.4767, df = 369, p-value = 0.1406
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.02536446  0.17708380
## sample estimates:
##        cor 
## 0.07664964</code></pre>
<p>Autocorrelation structure of residuals by estimates of the correlations at multiple lags. See significant residual correlations at many lags (significance is indicates by extention beyond the blue dashed lines).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="multiple-regression-models.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">ts</span>(<span class="fu">resid</span>(model1)),<span class="dv">36</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="trends-and-seasonality.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/katjanewilson/Time-Series-Forecasting/edit/master/02-topic.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/katjanewilson/Time-Series-Forecasting/blob/master/02-topic.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
